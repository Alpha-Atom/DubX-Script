function helloUser(){var e=Dubtrack.session.get("username");$(".isUser").text(e)}function toggleControls(){$(".isSwordful").slideToggle("fast")}function hello(){var e='<li><button onclick="toggleControls();" class="relate" style="font-size: 1em;height: 32px;margin-right: 16px;border-radius: 0.1875em;">DUB X</button></li>',t=['<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.css">','<link rel="stylesheet" type="text/css" href="https://rawgit.com/sinfulBA/DubX-Script/master/asset.css">','<div class="isSwordful">','<div class="verSwordful">','<p class="Javaling">DubX Settings</p>','<p class="Javaful">Version 02.00.00 - The Cake is a LIE!</p>',"</div>",'<ul class="optionSwordful">','<li class="optionClass">','<p class="Optionling" style="margin: 0;">Greetings, <span class="isUser"></span></p>',"</li>",'<li class="titleClass">','<p class="istitle">Standard</p>',"</li>",'<li onclick="optionAutovote();" class="optionClass autovote">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Autovote</p>',"</li>",'<li onclick="optionFullscreen();" class="optionClass fullscreen">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Fullscreen</p>',"</li>",'<li onclick="optionWork();" class="optionClass work">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Work Mode</p>',"</li>",'<li onclick="optionSplitChat();" class="optionClass splitchat">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Split Chat</p>',"</li>",'<li onclick="optionChat();" class="optionClass showchat">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Chat Only</p>',"</li>",'<li onclick="isBackgroundToggle();" class="optionClass removestretch">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Hide Background</p>',"</li>",'<li onclick="optionAutorespond();" class="optionClass afk">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">AFK Auto-Respond</p>',"</li>",'<li onclick="optionOnBeforeUnload();" class="optionClass onbeforeunload">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Prompt On Before Unload</p>',"</li>",'<li onclick="communityCSS();" class="optionClass communitycss">','<p class="isOnOff"><i class="fi-x"></i></p>','<p class="Optionling">Community CSS</p>',"</li>",'<li class="titleClass">','<p class="istitle">Support</p>',"</li>",'<li class="optionClass support">','<a href="https://docs.google.com/document/d/1IhVn4fUA4Qd4TJCX6jmrp10ztVVn6pn8MT5Va69HiEM/edit?usp=drivesdk" target="_blank" style="color: white;">','<p class="isOnOff"><i class="fi-paint-bucket"></i></p>','<p class="Optionling">How-to: Community CSS</p>',"</a>","</li>",'<li class="titleClass">','<p class="istitle">Contact</p>',"</li>",'<li onclick="showReport();" class="optionClass report">','<p class="isOnOff"><i class="fi-comments"></i></p>','<p class="Optionling">Bug Report</p>',"</li>",'<li class="titleClass">','<p class="istitle">Customize</p>',"</li>",'<li onclick="openCSS();" class="optionClass custominput">','<p class="isOnOff"><i class="fi-unlink"></i></p>','<p class="Optionling">Custom CSS</p>',"</li>",'<li onclick="openCustom();" class="optionClass customupload">','<p class="isOnOff"><i class="fi-unlink"></i></p>','<p class="Optionling">Custom Background</p>',"</li>",'<li class="titleClass">','<p class="istitle">Disabled</p>',"</li>",'<li class="optionClass request">','<p class="isOnOff"><i class="fi-prohibited"></i></p>','<p class="Optionling">Feature Request</p>',"</li>",'<li class="titleClass">','<p class="istitle">Social</p>',"</li>",'<li class="optionClass facebook">','<a href="https://www.facebook.com/DubXScript" target="_blank" style="color: white;">','<p class="isOnOff"><i class="fi-social-facebook"></i></p>','<p class="Optionling">Like Us on Facebook</p>',"</a>","</li>",'<li class="optionClass twitter">','<a href="https://twitter.com/DubXScript" target="_blank" style="color: white;">','<p class="isOnOff"><i class="fi-social-twitter"></i></p>','<p class="Optionling">Follow Us on Twitter</p>',"</a>","</li>",'<li class="optionClass github">','<a href="https://github.com/sinfulBA/DubX-Script" target="_blank" style="color: white;">','<p class="isOnOff"><i class="fi-social-github"></i></p>','<p class="Optionling">Fork Us on Github</p>',"</a>","</li>",'<li class="optionClass website">','<a href="https://dubx.net" target="_blank" style="color: white;">','<p class="isOnOff"><i class="fi-web"></i></p>','<p class="Optionling">Check out our Website</p>',"</a>","</li>","</ul>","</div>"].join(""),s=document.querySelector(".user-header-menu"),o=document.querySelector("body");$(s).prepend(e),$(o).prepend(t),helloUser()}function input(e,t,s,o){var i=['<div class="onErr">','<div class="container">','<div class="title">',"<h1>"+e+"</h1>","</div>",'<div class="content">',"<p>"+t+"</p>",'<textarea class="input" type="text" placeholder="'+s+'"></textarea>',"</div>",'<div class="control">','<div class="cancel">',"<p>Cancel</p>","</div>",'<div class="'+o+' confirm">',"<p>Okay</p>","</div>","</div>","</div>","</div>"].join("");$("body").prepend(i)}function toggleOptionOn(e){$(e+" .isOnOff i").replaceWith('<i class="fi-check"></i>')}function toggleOptionOff(e){$(e+" .isOnOff i").replaceWith('<i class="fi-x"></i>')}function closeErr(){$(".onErr").remove()}function optionAutovote(){function e(){s.click()}var t;if(isAutovote)isAutovote=!1,t="off",Dubtrack.Events.unbind("realtime:room_playlist-update",e),localStorage.setItem("isAutovote","false"),toggleOptionOff(".autovote");else{isAutovote=!0,t="on";var s=document.querySelector(".dubup");s.click(),Dubtrack.Events.bind("realtime:room_playlist-update",e),localStorage.setItem("isAutovote","true"),toggleOptionOn(".autovote")}}function optionSplitChat(){var e;isSplitChat?(isSplitChat=!1,e="off",$(".chat-main li:nth-child(even)").removeClass("split"),$(".chat-main li:nth-child(even) .chatDelete").removeClass("splitfix"),localStorage.setItem("isSplitChat","false"),toggleOptionOff(".splitchat")):(isSplitChat=!0,e="on",$(".chat-main li:nth-child(even)").addClass("split"),$(".chat-main li:nth-child(even) .chatDelete").addClass("splitfix"),localStorage.setItem("isSplitChat","true"),toggleOptionOn(".splitchat"))}function boothDuration(){var e=4,t=$("#player-controller div.left ul li.infoContainer.display-block div.currentTime span.min").text(),s=parseInt(t),o=Dubtrack.room.player.queueInfo.text(),i=parseInt(o),l=i*e-e+s;l>=0&&$(".durationRemaining").replaceWith('<span class="durationRemaining">You will be on the booth in approximately '+l+" minutes.</span>")}function reportPost(){var e=Dubtrack.session.get("username"),t=Dubtrack.realtime.dtPubNub.get_uuid(),s=$(".input").val(),o=location.href,i="*Username:* "+e+"  |  *ID:* "+t+"  |  *Report:* "+s+"  |  *Location:* `"+o+"`";$.ajax({type:"POST",url:"https://hooks.slack.com/services/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",data:'payload={"username": "Incoming Bug Report", "text": "'+i+'", "icon_emoji": ":bug:"}',crossDomain:!0}).done(function(e){console.log(e)})}function postreport(){reportPost(),$(".onErr").remove(),toggleOptionOn(".report")}function cancelreport(){$(".onErr").remove()}function showReport(){input("Bug Report:","Report:","Please give a detailed description of the bug.","confirm-for36","cancel"),$(".confirm-for36").click(postreport),$(".cancel").click(cancelreport)}function fullscreenOff(){$("#room-comments").show(),$(".main-page-container").removeClass("fullscreenFix"),$("#main-room").removeClass("fullscreenParent"),$(".left_section").removeClass("fullscreenLeft"),$(".right_section").removeClass("fullscreenRight"),$("#chat").removeClass("fullscreenChat"),$(".chat-messages").removeClass("fullscreenChatChild"),$("#main_player").removeClass("fullscreenVideo"),$(".player_container").removeClass("fullscreenVideoChild"),$("#player-controller").removeClass("fullscreenController"),isFullscreen=!1,isOn="off",localStorage.setItem("isFullscreen","false"),toggleOptionOff(".fullscreen")}function optionFullscreen(){var e;isFullscreen?fullscreenOff():(isFullscreen=!0,$("#room-comments").hide(),$(".main-page-container").addClass("fullscreenFix"),$("#main-room").addClass("fullscreenParent"),$(".left_section").addClass("fullscreenLeft"),$(".right_section").addClass("fullscreenRight"),$("#chat").addClass("fullscreenChat"),$(".chat-messages").addClass("fullscreenChatChild"),$("#main_player").addClass("fullscreenVideo"),$(".player_container").addClass("fullscreenVideoChild"),$("#player-controller").addClass("fullscreenController"),e="on",localStorage.setItem("isFullscreen","true"),toggleOptionOn(".fullscreen"))}function isBackgroundToggle(){var e;isBackground?(isBackground=!1,e="off",$(".backstretch").show(),$(".userCustomB").show(),localStorage.setItem("isBackground","false"),toggleOptionOff(".removestretch")):(isBackground=!0,e="on",$(".backstretch").hide(),$(".userCustomB").hide(),localStorage.setItem("isBackground","true"),toggleOptionOn(".removestretch"))}function disableWork(){isWork=!1,$("#main-room").show(),isOn="off",localStorage.setItem("isWork","false"),toggleOptionOff(".work")}function optionWork(){var e;isWork?disableWork():(isWork=!0,$("#main-room").hide(),fullscreenOff(),e="on",localStorage.setItem("isWork","true"),toggleOptionOn(".work"))}function optionOnBeforeUnload(){var e;isOnBeforeUnload?(isOnBeforeUnload=!1,e="off",window.onbeforeunload=null,localStorage.setItem("isOnBeforeUnload","false"),toggleOptionOff(".onbeforeunload")):(isOnBeforeUnload=!0,e="on",window.onbeforeunload=function(){return"You sure about that?"},localStorage.setItem("isOnBeforeUnload","true"),toggleOptionOn(".onbeforeunload"))}function realtimeChat(e){var t=e.message,s=Dubtrack.session.get("username");t.indexOf("@"+s)>-1&&sendAutorespond&&($("#chat-txt-message").val("I am AFK at the moment."),Dubtrack.room.chat.sendMessage(),sendAutorespond=!1,setTimeout(function(){sendAutorespond=!0},3e4))}function optionAutorespond(){var e;isAutorespond?(isAutorespond=!1,e="off",Dubtrack.Events.unbind("realtime:chat-message",realtimeChat),toggleOptionOff(".afk")):(isAutorespond=!0,e="on",Dubtrack.Events.bind("realtime:chat-message",realtimeChat),toggleOptionOn(".afk"))}function optionChat(){var e;isChat?(isChat=!1,e="off",$(".isChat").remove(),localStorage.setItem("isChat","false"),toggleOptionOff(".showchat")):(isChat=!0,e="on",$("body").append('<style class="isChat">.left_section {display: none !important;}.right_section {width: 428.4px !important;margin: 0 auto !important;right: initial !important;position: relative !important;float: inherit !important;}</style>'),localStorage.setItem("isChat","true"),toggleOptionOn(".showchat"))}function openCSS(){var e="Current file: "+localStorage.getItem("userCSS");input("Link a .CSS file:",e,"https://example.com/example.css","confirm-for313"),$(".confirm-for313").click(importCSS),$(".cancel").click(closeErr)}function importCSS(){$(".customCSS").remove();var e=$(".input").val();localStorage.setItem("userCSS",e),$("head").append('<link class="customCSS" href="'+e+'" rel="stylesheet" type="text/css">'),$(".onErr").remove()}function loadCSS(){if(null!==localStorage.getItem("userCSS")){var e=localStorage.getItem("userCSS");$("head").append('<link class="customCSS" href="'+e+'" rel="stylesheet" type="text/css">')}}function openCustom(){input("Link an image file:","It is recommended a .jpg file is used","https://example.com/example.jpg","confirm-for314"),$(".confirm-for314").click(importCustom),$(".cancel").click(closeErr)}function importCustom(){var e=$(".input").val();localStorage.setItem("userCustom",e),$(".userCustomB").remove(),$("body").append('<div class="userCustomB" style="width: 100vw;height: 100vh;z-index: -999998;position: fixed; background: url('+e+');background-size: cover;top: 0;"></div>'),$(".onErr").remove()}function loadCustom(){if(null!==localStorage.getItem("userCustom")){var e=localStorage.getItem("userCustom");$("body").append('<div class="userCustomB" style="width: 100vw;height: 100vh;z-index: -999998;position: fixed; background: url('+e+');background-size: cover;top: 0;"></div>')}}function communityCSS(){var e;if(isCommunityCSS)isCommunityCSS=!1,e="off",$(".importcommunitycss").remove(),localStorage.setItem("communitycss","false"),toggleOptionOff(".communitycss");else{isCommunityCSS=!0,e="on";var t=Dubtrack.room.model.get("roomUrl");$.ajax({type:"GET",url:"https://api.dubtrack.fm/room/"+t}).done(function(e){var t=e.data.description,s=/(@dubx=)(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/,o=t.match(s),i=o[0].split("@dubx=");$("head").append('<link class="importcommunitycss" href="'+i[1]+'" rel="stylesheet" type="text/css">')}),localStorage.setItem("communitycss","true"),toggleOptionOn(".communitycss")}}function onErr(e){var t=['<div class="onErr">','<div class="container">','<div class="title">',"<h1>Oh noes:</h1>","</div>",'<div class="content">',"<p>"+e+"</p>","</div>",'<div class="control">','<div class="cancel">',"<p>Cancel</p>","</div>",'<div class="confirm confirm-err">',"<p>Okay</p>","</div>","</div>","</div>","</div>"].join(""),s=document.querySelector("body");$(s).prepend(t)}if(isOpen)onErr("Oh noes! E001: Extension is open twice."),$(".cancel").click(closeErr),$(".confirm-err").click(closeErr);else{var isOpen=!0;hello();var isAutovote=!1;"true"===localStorage.getItem("isAutovote")&&optionAutovote();var isSplitChat=!1;"true"===localStorage.getItem("isSplitChat")&&optionSplitChat(),$(".player_sharing").append('<span class="durationRemaining"></span>'),Dubtrack.Events.bind("realtime:room_playlist-update",boothDuration);var isFullscreen=!1;"true"===localStorage.getItem("isFullscreen")&&optionFullscreen(),$(".user-info-button").click(fullscreenOff),window.addEventListener("resize",function(){var e=$(window).width();1185>=e&&fullscreenOff()},!0);var isBackground=!1;"true"===localStorage.getItem("isBackground")&&isBackgroundToggle();var isWork=!1;"true"===localStorage.getItem("isWork")&&optionWork(),$(".user-info-button").click(disableWork);var isOnBeforeUnload=!1;"true"===localStorage.getItem("isOnBeforeUnload")&&optionOnBeforeUnload();var isAutorespond=!1,sendAutorespond=!0,isChat=!1;"true"===localStorage.getItem("isChat")&&optionChat(),$("document").ready(loadCSS),$("document").ready(loadCustom);var isCommunityCSS=!1;"true"===localStorage.getItem("communitycss")&&communityCSS()}
